# ðŸš€ Deployment Guide - Render + PostgreSQL

## **Prerequisites**
- GitHub account
- Render account (free)

## **Step 1: Prepare Your Code**

### **1.1 Update Prisma Schema (Already Done)**
âœ… Changed from MySQL to PostgreSQL in `prisma/schema.prisma`

### **1.2 Generate Prisma Client**
```bash
npm run db:generate
```

### **1.3 Commit and Push to GitHub**
```bash
git add .
git commit -m "Migrate to PostgreSQL and prepare for Render deployment"
git push origin main
```

## **Step 2: Deploy on Render**

### **2.1 Create Render Account**
1. Go to [render.com](https://render.com)
2. Sign up with GitHub
3. Verify your email

### **2.2 Deploy Using Blueprint (Recommended)**

#### **Option A: Using render.yaml (Automatic)**
1. Click "New +" â†’ "Blueprint"
2. Connect your GitHub repository
3. Select the repository with your backend
4. Render will automatically detect `render.yaml`
5. Click "Apply" to deploy

#### **Option B: Manual Setup**
1. Click "New +" â†’ "Web Service"
2. Connect GitHub repository
3. Configure:
   - **Name**: `todo-backend`
   - **Environment**: `Node`
   - **Build Command**: `npm install && npm run build`
   - **Start Command**: `npm start`
   - **Plan**: `Free`

### **2.3 Set Environment Variables**
In your Render service dashboard:

```
NODE_ENV=production
JWT_SECRET=your-super-secret-jwt-key-here
PORT=10000
CORS_ORIGIN=https://your-frontend-domain.vercel.app
```

### **2.4 Create PostgreSQL Database**
1. Click "New +" â†’ "PostgreSQL"
2. Configure:
   - **Name**: `todo-postgres`
   - **Database**: `todo_db`
   - **User**: `todo_user`
   - **Plan**: `Free`
3. Copy the connection string
4. Add to environment variables:
   ```
   DATABASE_URL=postgresql://... (from Render)
   ```

## **Step 3: Database Setup**

### **3.1 Run Database Migrations**
1. Go to your service dashboard
2. Click "Shell" tab
3. Run commands:
   ```bash
   npx prisma db push
   npx prisma generate
   ```

### **3.2 (Optional) Seed Database**
```bash
npm run db:seed
```

## **Step 4: Update Frontend**

### **4.1 Update API Base URL**
In your frontend `.env`:
```
VITE_API_BASE_URL=https://your-backend-name.onrender.com
```

### **4.2 Update CORS Settings**
In your backend, ensure CORS allows your frontend domain:
```javascript
app.use(cors({
  origin: process.env.CORS_ORIGIN || "https://your-frontend-domain.vercel.app",
  credentials: true
}));
```

## **Step 5: Test Deployment**

### **5.1 Test API Endpoints**
```bash
# Health check
curl https://your-backend-name.onrender.com/api/health

# Register user
curl -X POST https://your-backend-name.onrender.com/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"name":"Test User","email":"test@example.com","password":"password123"}'
```

### **5.2 Test Frontend Integration**
1. Deploy frontend to Vercel
2. Test login/register functionality
3. Test CRUD operations

## **ðŸš¨ Important Notes**

### **Free Tier Limitations**
- **Cold starts**: 15-minute sleep after inactivity
- **Database**: 1GB storage, 90-day retention
- **Bandwidth**: 750 hours/month

### **Environment Variables**
- `DATABASE_URL`: Auto-generated by Render
- `JWT_SECRET`: Generate a strong secret
- `CORS_ORIGIN`: Your frontend domain
- `PORT`: Render uses 10000

### **Troubleshooting**
- **Cold start**: First request takes 3-12 seconds
- **Database connection**: Check connection string format
- **CORS errors**: Verify CORS_ORIGIN setting
- **Build errors**: Check build logs in Render dashboard

## **ðŸŽ¯ Next Steps**
1. Deploy frontend to Vercel
2. Update frontend API URL
3. Test complete application
4. Monitor performance and logs

## **ðŸ“ž Support**
- Render Documentation: [docs.render.com](https://docs.render.com)
- Prisma Documentation: [pris.ly](https://pris.ly)
- PostgreSQL on Render: [render.com/docs/databases](https://render.com/docs/databases)
